<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shadow DOM Test - Live Highlighter</title>
    <style>
      :root {
        --bg-page: #f5f5f5;
        --bg-card: #ffffff;
        --bg-subtle: #f8f9fa;
        --text-primary: #202124;
        --text-secondary: #5f6368;
        --accent: #1a73e8;
        --border: #dadce0;
        --shadow: rgba(0, 0, 0, 0.1);
      }

      [data-theme="dark"] {
        --bg-page: #202124;
        --bg-card: #292a2d;
        --bg-subtle: #3c4043;
        --text-primary: #e8eaed;
        --text-secondary: #9aa0a6;
        --accent: #8ab4f8;
        --border: #5f6368;
        --shadow: rgba(0, 0, 0, 0.3);
      }

      body {
        font-family: "Segoe UI", Roboto, sans-serif;
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 20px;
        background: var(--bg-page);
        transition: background-color 0.3s, color 0.3s;
      }
      .header {
        background: var(--bg-card);
        padding: 30px;
        border-radius: 8px;
        margin-bottom: 30px;
        box-shadow: 0 2px 8px var(--shadow);
        position: relative;
      }
      h1 {
        color: var(--accent);
        margin: 0 0 10px;
      }
      .header p {
        color: var(--text-primary);
      }
      .header strong {
        color: var(--text-primary);
      }
      .test-section {
        background: var(--bg-card);
        padding: 30px;
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px var(--shadow);
      }
      h2 {
        color: var(--text-primary);
        margin-top: 0;
      }
      .test-section p {
        color: var(--text-primary);
      }
      .component {
        margin: 20px 0;
        padding: 15px;
        border: 2px dashed var(--border);
        border-radius: 4px;
      }

      .theme-toggle {
        position: absolute;
        top: 30px;
        right: 30px;
        background: var(--bg-subtle);
        border: 1px solid var(--text-secondary);
        color: var(--text-primary);
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s;
      }
      .theme-toggle:hover {
        background: var(--accent);
        color: white;
        border-color: var(--accent);
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Shadow DOM Test</h1>
      <button class="theme-toggle" id="themeToggle">üåô Dark Mode</button>
      <p>
        This page tests Live Highlighter's ability to highlight text inside
        Shadow DOM components.
      </p>
      <p>
        <strong>Test keywords:</strong> error, success, resource, tags, data
      </p>
    </div>

    <div class="test-section">
      <h2>Regular DOM (Control)</h2>
      <p>
        This paragraph contains test words in regular DOM: error, success,
        resource, tags, data.
      </p>
    </div>

    <div class="test-section">
      <h2>Shadow DOM Components</h2>
      <div id="shadow1" class="component"></div>
      <div id="shadow2" class="component"></div>
      <div id="shadow3" class="component"></div>
    </div>

    <div class="test-section">
      <h2>Nested Shadow DOM</h2>
      <div id="nestedShadow" class="component"></div>
    </div>

    <div class="test-section">
      <h2>Dynamic Shadow DOM</h2>
      <button id="addShadowBtn" style="padding: 10px 20px; background: var(--accent); color: white; border: none; border-radius: 4px; cursor: pointer;">
        Add Shadow Component
      </button>
      <div id="dynamicContainer"></div>
    </div>

    <script>
      // Theme toggle functionality
      const themeToggle = document.getElementById('themeToggle');
      const html = document.documentElement;

      // Load saved theme or default to light
      const savedTheme = localStorage.getItem('test-theme') || 'light';
      html.setAttribute('data-theme', savedTheme);
      updateToggleButton(savedTheme);

      themeToggle.addEventListener('click', () => {
        const currentTheme = html.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('test-theme', newTheme);
        updateToggleButton(newTheme);
      });

      function updateToggleButton(theme) {
        themeToggle.textContent = theme === 'dark' ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
      }

      // Create shadow DOM components
      const shadow1 = document
        .getElementById("shadow1")
        .attachShadow({ mode: "open" });
      shadow1.innerHTML = `
      <style>
        :host { display: block; }
        p { color: #202124; margin: 10px 0; }
      </style>
      <h3>Shadow Component #1</h3>
      <p>This text is inside a shadow DOM. Test words: error, success, resource.</p>
      <p>Multiple occurrences: error error error, success success, tags tags.</p>
    `;

      const shadow2 = document
        .getElementById("shadow2")
        .attachShadow({ mode: "open" });
      shadow2.innerHTML = `
      <style>
        :host { display: block; }
        .card { background: #f8f9fa; padding: 15px; border-radius: 4px; }
      </style>
      <h3>Shadow Component #2 (Styled)</h3>
      <div class="card">
        <p>Styled shadow DOM content with error handling and success messages.</p>
        <p>Resource management and data processing with proper tags.</p>
      </div>
    `;

      const shadow3 = document
        .getElementById("shadow3")
        .attachShadow({ mode: "open" });
      shadow3.innerHTML = `
      <style>
        :host { display: block; }
        ul { margin: 10px 0; padding-left: 20px; }
      </style>
      <h3>Shadow Component #3 (List)</h3>
      <ul>
        <li>Error handling in shadow DOM</li>
        <li>Success metrics and resource allocation</li>
        <li>Data processing with tags</li>
        <li>More error and success cases</li>
      </ul>
    `;

      // Nested shadow DOM
      const nestedOuter = document
        .getElementById("nestedShadow")
        .attachShadow({ mode: "open" });
      nestedOuter.innerHTML = `
      <style>
        :host { display: block; }
        .outer { background: #e8f5e9; padding: 15px; border-radius: 4px; }
      </style>
      <div class="outer">
        <h3>Outer Shadow DOM</h3>
        <p>This is the outer shadow with error and success messages.</p>
        <div id="innerHost"></div>
      </div>
    `;

      const nestedInner = nestedOuter
        .querySelector("#innerHost")
        .attachShadow({ mode: "open" });
      nestedInner.innerHTML = `
      <style>
        :host { display: block; margin-top: 10px; }
        .inner { background: #fff3e0; padding: 15px; border-radius: 4px; }
      </style>
      <div class="inner">
        <h4>Inner Shadow DOM (Nested)</h4>
        <p>Nested shadow DOM with resource and data management.</p>
        <p>Testing tags and error handling deep inside.</p>
      </div>
    `;

      // Dynamic shadow components
      let shadowCount = 0;
      document.getElementById("addShadowBtn").addEventListener("click", () => {
        shadowCount++;
        const container = document.getElementById("dynamicContainer");
        const div = document.createElement("div");
        div.className = "component";
        div.style.marginTop = "15px";
        container.appendChild(div);

        const shadow = div.attachShadow({ mode: "open" });
        shadow.innerHTML = `
        <style>
          :host { display: block; }
          .dynamic { background: #f3e5f5; padding: 15px; border-radius: 4px; }
        </style>
        <div class="dynamic">
          <h4>Dynamic Shadow Component #${shadowCount}</h4>
          <p>Dynamically added shadow DOM at ${new Date().toLocaleTimeString()}</p>
          <p>Contains error, success, resource, data, and tags keywords.</p>
        </div>
      `;
      });

      // Add some components on load
      setTimeout(() => {
        document.getElementById("addShadowBtn").click();
      }, 100);
    </script>
  </body>
</html>
