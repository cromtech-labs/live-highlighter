<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Overlapping Text Test - Live Highlighter</title>
    <style>
      :root {
        --bg-page: #f5f5f5;
        --bg-card: #ffffff;
        --bg-subtle: #f8f9fa;
        --bg-warning: #fff3e0;
        --text-primary: #202124;
        --text-secondary: #5f6368;
        --accent: #1a73e8;
        --accent-warning: #fb8c00;
        --shadow: rgba(0, 0, 0, 0.1);
      }

      [data-theme="dark"] {
        --bg-page: #202124;
        --bg-card: #292a2d;
        --bg-subtle: #3c4043;
        --bg-warning: #3e2723;
        --text-primary: #e8eaed;
        --text-secondary: #9aa0a6;
        --accent: #8ab4f8;
        --accent-warning: #ffa726;
        --shadow: rgba(0, 0, 0, 0.3);
      }

      body {
        font-family: "Segoe UI", Roboto, sans-serif;
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 20px;
        background: var(--bg-page);
        color: var(--text-primary);
        transition: background-color 0.3s, color 0.3s;
      }
      .header {
        background: var(--bg-card);
        padding: 30px;
        border-radius: 8px;
        margin-bottom: 30px;
        box-shadow: 0 2px 8px var(--shadow);
        position: relative;
      }
      h1 {
        color: var(--accent);
        margin: 0 0 10px;
      }
      .test-section {
        background: var(--bg-card);
        padding: 30px;
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 8px var(--shadow);
      }
      h2 {
        color: var(--text-primary);
        margin-top: 0;
      }
      .test-case {
        padding: 15px;
        background: var(--bg-subtle);
        margin: 15px 0;
        border-radius: 4px;
        border-left: 4px solid var(--accent);
      }
      .label {
        font-size: 12px;
        color: var(--text-secondary);
        font-weight: 500;
        margin-bottom: 8px;
      }
      .priority-info {
        background: var(--bg-warning);
        padding: 15px;
        border-radius: 4px;
        margin-bottom: 20px;
        border-left: 4px solid var(--accent-warning);
      }
      code {
        background: var(--bg-subtle);
        padding: 2px 6px;
        border-radius: 3px;
        font-family: "Courier New", monospace;
        font-size: 13px;
        color: var(--text-primary);
      }
      .theme-toggle {
        position: absolute;
        top: 30px;
        right: 30px;
        background: var(--bg-subtle);
        border: 1px solid var(--text-secondary);
        color: var(--text-primary);
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s;
      }
      .theme-toggle:hover {
        background: var(--accent);
        color: white;
        border-color: var(--accent);
      }
    </style>
  </head>
  <body>
    <div class="header">
      <button class="theme-toggle" id="themeToggle">üåô Dark Mode</button>
      <h1>Overlapping Text Test</h1>
      <p>
        This page tests how Live Highlighter handles overlapping text matches
        where multiple groups could apply to the same text.
      </p>
      <p>
        <strong>Priority rule:</strong> First matching group wins (based on group
        order in settings)
      </p>
    </div>

    <div class="test-section">
      <h2>How Priority Works</h2>
      <div class="priority-info">
        <p>
          <strong>Group Priority:</strong> When multiple groups match the same
          text, the first group in your list takes precedence.
        </p>
        <p>For example, if you have:</p>
        <ol style="margin: 10px 0; padding-left: 20px">
          <li>Group #1 (Yellow): Contains word "error"</li>
          <li>Group #2 (Orange): Contains phrase "error handling"</li>
        </ol>
        <p>
          The text "error handling" will be highlighted as:
          <code>error</code> (yellow) + <code> handling</code> (no highlight),
          because "error" from Group #1 matches first.
        </p>
      </div>
    </div>

    <div class="test-section">
      <h2>Test Cases</h2>

      <div class="test-case">
        <div class="label">Case 1: Exact Word Repetition</div>
        <p>
          error error error success success resource resource data data tags
          tags
        </p>
        <p><em>Expected: Each word highlighted independently</em></p>
      </div>

      <div class="test-case">
        <div class="label">Case 2: Words in Phrases</div>
        <p>
          The error handling system detects errors and logs error messages for
          error recovery.
        </p>
        <p><em>Expected: Each "error" occurrence highlighted separately</em></p>
      </div>

      <div class="test-case">
        <div class="label">Case 3: Substring Matches</div>
        <p>
          successful success successfully, resource resources resourceful, data
          database datastore
        </p>
        <p>
          <em
            >Expected: Only exact matches highlighted (success, resource,
            data)</em
          >
        </p>
      </div>

      <div class="test-case">
        <div class="label">Case 4: Consecutive Matches</div>
        <p>
          errorsuccess (no space), error success (with space), error-success
          (hyphenated)
        </p>
        <p>
          <em>Expected: Only separated words highlighted, not concatenated</em>
        </p>
      </div>

      <div class="test-case">
        <div class="label">Case 5: Case Insensitive</div>
        <p>
          ERROR Error error, SUCCESS Success success, RESOURCE Resource resource
        </p>
        <p>
          <em
            >Expected: All variations highlighted (case insensitive
            matching)</em
          >
        </p>
      </div>

      <div class="test-case">
        <div class="label">Case 6: Prefix Pattern (kv-)</div>
        <p>kv-store, kv-cache, kv-database, kv-123, kv-production-data</p>
        <p><em>Expected: All "kv-" occurrences highlighted</em></p>
      </div>

      <div class="test-case">
        <div class="label">Case 7: Multiple Keywords in Sentence</div>
        <p>
          The resource manager detected an error while processing data with tags
          from the kv-store, but the operation completed with success.
        </p>
        <p>
          <em
            >Expected: resource, error, data, tags, kv-, success all
            highlighted</em
          >
        </p>
      </div>

      <div class="test-case">
        <div class="label">Case 8: Dense Keyword Concentration</div>
        <p>
          error resource data tags kv-store success error resource data tags
          kv-cache success
        </p>
        <p><em>Expected: All keywords highlighted in sequence</em></p>
      </div>

      <div class="test-case">
        <div class="label">Case 9: Keywords in Different Contexts</div>
        <ul>
          <li>System error occurred</li>
          <li>Resource allocation success</li>
          <li>Data tags updated</li>
          <li>kv-store connection established</li>
        </ul>
        <p><em>Expected: Keywords highlighted in list items</em></p>
      </div>

      <div class="test-case">
        <div class="label">Case 10: Keywords in Table</div>
        <table style="width: 100%; border-collapse: collapse">
          <tr style="border-bottom: 1px solid #ddd">
            <th style="padding: 8px; text-align: left">Event</th>
            <th style="padding: 8px; text-align: left">Status</th>
            <th style="padding: 8px; text-align: left">Details</th>
          </tr>
          <tr style="border-bottom: 1px solid #ddd">
            <td style="padding: 8px">error detected</td>
            <td style="padding: 8px">failure</td>
            <td style="padding: 8px">resource unavailable</td>
          </tr>
          <tr style="border-bottom: 1px solid #ddd">
            <td style="padding: 8px">data sync</td>
            <td style="padding: 8px">success</td>
            <td style="padding: 8px">tags updated from kv-store</td>
          </tr>
        </table>
        <p><em>Expected: Keywords highlighted in table cells</em></p>
      </div>

      <div class="test-case">
        <div class="label">Case 11: Adjacent Keywords</div>
        <p>
          datasuccess (concatenated), data success (spaced), data-success
          (hyphenated), data/success (slashed)
        </p>
        <p>
          <em
            >Expected: Only spaced versions highlighted as separate matches</em
          >
        </p>
      </div>

      <div class="test-case">
        <div class="label">Case 12: Keywords at Boundaries</div>
        <p>
          error, success. resource! data? tags; kv-store: (keywords with
          punctuation)
        </p>
        <p>
          <em
            >Expected: All keywords highlighted, punctuation not highlighted</em
          >
        </p>
      </div>

      <div class="test-case">
        <div class="label">Case 13: Very Long Text with Scattered Keywords</div>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. An error
          occurred during processing. Sed do eiusmod tempor incididunt ut labore
          et dolore magna aliqua. The operation completed with success. Ut enim
          ad minim veniam, quis nostrud exercitation. Resource allocation was
          optimized. Ullamco laboris nisi ut aliquip ex ea commodo consequat.
          Data synchronization finished. Duis aute irure dolor in reprehenderit.
          Tags were updated in the kv-store. Voluptate velit esse cillum dolore
          eu fugiat nulla pariatur.
        </p>
        <p><em>Expected: Keywords highlighted throughout the paragraph</em></p>
      </div>
    </div>

    <div class="test-section">
      <h2>Performance Test</h2>
      <div class="test-case">
        <div class="label">Case 14: High Density Keywords (100+ matches)</div>
        <p id="densePara"></p>
        <p><em>Expected: All matches highlighted with good performance</em></p>
      </div>
    </div>

    <script>
      // Theme toggle functionality
      const themeToggle = document.getElementById('themeToggle');
      const html = document.documentElement;

      // Load saved theme or default to light
      const savedTheme = localStorage.getItem('test-theme') || 'light';
      html.setAttribute('data-theme', savedTheme);
      updateToggleButton(savedTheme);

      themeToggle.addEventListener('click', () => {
        const currentTheme = html.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('test-theme', newTheme);
        updateToggleButton(newTheme);
      });

      function updateToggleButton(theme) {
        themeToggle.textContent = theme === 'dark' ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
      }

      // Generate high-density keyword paragraph
      const keywords = [
        "error",
        "success",
        "resource",
        "data",
        "tags",
        "kv-store",
      ];
      const densePara = document.getElementById("densePara");
      let denseText = "";
      for (let i = 0; i < 100; i++) {
        denseText += keywords[i % keywords.length] + " ";
        if ((i + 1) % 10 === 0) denseText += "| "; // Add separators every 10 words
      }
      densePara.textContent = denseText;
    </script>
  </body>
</html>
